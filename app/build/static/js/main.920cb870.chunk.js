(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(8),c=n.n(i),l=(n(14),n(6)),r=n(2),u=n(3),s=n(1),d=n(4),h=n(5),p=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return o.a.createElement("div",null,"No pages found.")}}]),n}(o.a.Component),b=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(r.a)(this,n),(e=t.call(this)).state={confirm:!1},e.deleteNode=e.deleteNode.bind(Object(s.a)(e)),e.showConfirm=e.showConfirm.bind(Object(s.a)(e)),e.cancelDelete=e.cancelDelete.bind(Object(s.a)(e)),e}return Object(u.a)(n,[{key:"deleteNode",value:function(e){this.props.deleteNode(e),this.cancelDelete()}},{key:"showConfirm",value:function(){this.setState({confirm:!0})}},{key:"cancelDelete",value:function(){this.setState({confirm:!1})}},{key:"render",value:function(){var e=this,t={panel:{margin:"30px",padding:"30px",backgroundColor:"#EEE"},inactive:{color:"#DDD"}};return o.a.createElement("div",null,!1===this.state.confirm&&o.a.createElement("button",{onClick:function(){return e.showConfirm()}},"Delete"),!0===this.state.confirm&&o.a.createElement("button",{style:t.inactive},"Delete"),!0===this.state.confirm&&o.a.createElement("div",{style:t.panel},o.a.createElement("div",null,"Delete this Node?"),o.a.createElement("br",null),o.a.createElement("button",{onClick:function(){return e.deleteNode(e.props.id)}},"Yes"),o.a.createElement("button",{onClick:function(){return e.cancelDelete()}},"No")))}}]),n}(o.a.Component),f=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this)).state={input:{title:e.title,body:e.body}},a.patchNode=a.patchNode.bind(Object(s.a)(a)),a.handleChange=a.handleChange.bind(Object(s.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(s.a)(a)),a}return Object(u.a)(n,[{key:"patchNode",value:function(){var e={data:{id:this.props.id,type:"node--article",attributes:{title:"".concat(this.state.input.title),body:{value:"".concat(this.input.value)}}}};console.log("NodeEdit: ",e),this.props.patchNode(this.props.id,e),this.props.cancelEdit()}},{key:"handleChange",value:function(e,t){var n=this;this.setState({input:Object(l.a)({},t,e.target.value)},(function(){return console.log(n.state)}))}},{key:"handleSubmit",value:function(e){this.patchNode(),e.preventDefault()}},{key:"render",value:function(){var e=this,t={form:{margin:"30px"},formItem:{margin:"10px"}};return o.a.createElement("form",{style:t.form,onSubmit:this.handleSubmit},o.a.createElement("input",{name:"title",type:"text",value:this.state.input.title,onChange:function(t){return e.handleChange(t,"title")},style:t.formItem}),o.a.createElement("br",null),o.a.createElement("textarea",{name:"body",id:"patch-body",type:"textarea",rows:"4",cols:"30",ref:function(t){return e.input=t},defaultValue:this.state.input.body,style:t.formItem}),o.a.createElement("br",null),o.a.createElement("input",{name:"submit",type:"submit",value:"Save",style:t.button}))}}]),n}(o.a.Component),m=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(r.a)(this,n),(e=t.call(this)).state={showEdit:!1},e.editNode=e.editNode.bind(Object(s.a)(e)),e.showEdit=e.showEdit.bind(Object(s.a)(e)),e.cancelEdit=e.cancelEdit.bind(Object(s.a)(e)),e}return Object(u.a)(n,[{key:"editNode",value:function(e){this.props.editNode(e)}},{key:"showEdit",value:function(e){this.setState({showEdit:!0}),e.preventDefault()}},{key:"cancelEdit",value:function(){this.setState({showEdit:!1})}},{key:"render",value:function(){var e=this,t={content:{margin:"30px",border:"5px solid #cbcbcb"},buttons:{margin:"30px"}};return o.a.createElement("div",{id:this.props.id},o.a.createElement("div",{style:t.content},o.a.createElement("h2",null,this.props.attributes.title),this.props.attributes.body&&o.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.attributes.body.value}})),o.a.createElement("hr",null),o.a.createElement("div",{style:t.buttons},!1===this.state.showEdit&&o.a.createElement("div",null,o.a.createElement("button",{onClick:function(t){return e.showEdit(t)}},"Edit")),!0===this.state.showEdit&&o.a.createElement("div",null,o.a.createElement(f,Object.assign({},this.props,{title:this.props.attributes.title,body:this.props.attributes.body.value,cancelEdit:this.cancelEdit})),o.a.createElement("button",{onClick:function(){return e.cancelEdit()}},"View")),o.a.createElement(b,this.props)))}}]),n}(o.a.Component),v=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props,t=e.data,n=e.patchNode,a=e.deleteNode;return o.a.createElement("div",null,null!==t&&void 0!==t.data&&null!==t.data&&t.data.length>0?t.data.map((function(e){return o.a.createElement(m,Object.assign({},e,{key:"node-".concat(e.id),patchNode:n,deleteNode:a}))})):o.a.createElement(p,null))}}]),n}(o.a.Component),y=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(r.a)(this,n),(e=t.call(this)).state={input:{title:""}},e.postNode=e.postNode.bind(Object(s.a)(e)),e.handleChange=e.handleChange.bind(Object(s.a)(e)),e.handleSubmit=e.handleSubmit.bind(Object(s.a)(e)),e}return Object(u.a)(n,[{key:"postNode",value:function(){var e={data:{type:"node--article",attributes:{title:"".concat(this.state.input.title),body:{value:"".concat(this.input.value),format:"plain_text"}}}};console.log("NodeNew: ",e),this.props.postNode(e)}},{key:"handleChange",value:function(e,t){var n=this;this.setState({input:Object(l.a)({},t,e.target.value)},(function(){return console.log(n.state)}))}},{key:"handleSubmit",value:function(e){this.postNode(),e.preventDefault(),this.setState({input:{title:""}}),document.getElementById("post-body").value=""}},{key:"render",value:function(){var e=this,t={form:{margin:"30px"},formItem:{margin:"10px"}};return o.a.createElement("form",{style:t.form,onSubmit:this.handleSubmit},o.a.createElement("h3",null,"Add a new article"),o.a.createElement("input",{name:"title",type:"text",value:this.state.input.title,placeholder:"Title",onChange:function(t){return e.handleChange(t,"title")},style:t.formItem}),o.a.createElement("br",null),o.a.createElement("textarea",{id:"post-body",name:"body",type:"textarea",rows:"4",cols:"30",ref:function(t){return e.input=t},placeholder:"Body",style:t.formItem}),o.a.createElement("br",null),o.a.createElement("input",{name:"submit",type:"submit",value:"Add Node",style:t.button}))}}]),n}(o.a.Component),E=(n(15),"https://my-drupal8-site.ddev.site:8300"),j="".concat(E,"/jsonapi/"),O=new Headers({Accept:"application/vnd.api+json","Content-Type":"application/vnd.api+json",Cache:"no-cache"}),N=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(r.a)(this,n),(e=t.call(this)).state={data:null},console.log("App"),e.loadNodeData=e.loadNodeData.bind(Object(s.a)(e)),e.postNode=e.postNode.bind(Object(s.a)(e)),e.patchNode=e.patchNode.bind(Object(s.a)(e)),e.deleteNode=e.deleteNode.bind(Object(s.a)(e)),e.fetchJsonApiGet=e.fetchJsonApiGet.bind(Object(s.a)(e)),e.fetchJsonApiPost=e.fetchJsonApiPost.bind(Object(s.a)(e)),e.fetchJsonApiPatch=e.fetchJsonApiPatch.bind(Object(s.a)(e)),e.fetchJsonApiDelete=e.fetchJsonApiDelete.bind(Object(s.a)(e)),e.updateData=e.updateData.bind(Object(s.a)(e)),e.checkInvalidData=e.checkInvalidData.bind(Object(s.a)(e)),e}return Object(u.a)(n,[{key:"componentWillMount",value:function(){this.loadNodeData()}},{key:"loadNodeData",value:function(){console.log("loadNodeData"),this.fetchJsonApiGet("data","".concat(j,"node/article"),!0)}},{key:"updateData",value:function(e,t){var n=this,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=this.checkInvalidData(t,a);(o||!1===a)&&this.setState(Object(l.a)({},e,t),(function(){return console.log("updateData: ",n.state)}))}},{key:"checkInvalidData",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!t||null!==e&&(void 0!==e.data&&null!==e.data)}},{key:"fetchWithCSRFToken",value:function(e,t){return t.headers.get("X-CSRF-Token")?fetch(e,t):fetch("".concat(E,"/session/token?_format=json")).then((function(e){return e.text()})).then((function(n){return t.headers.append("X-CSRF-Token",n),fetch(e,t)})).catch((function(e){return console.log("Unable to obtain CSRF token:",e)}))}},{key:"fetchJsonApiGet",value:function(e,t){var n=this;fetch(t).then((function(e){return e.json()})).then((function(t){return n.updateData(e,t)})).catch((function(e){return console.log("API error:",e)}))}},{key:"postNode",value:function(e){console.log("postNode: ",e),this.fetchJsonApiPost("post","".concat(j,"node/article"),e)}},{key:"fetchJsonApiPost",value:function(e,t,n){var a=this;this.fetchWithCSRFToken(t,{method:"POST",credentials:"same-origin",headers:O,body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(t){a.updateData(e,t,!1),a.loadNodeData()})).catch((function(e){return console.log("API error:",e)}))}},{key:"patchNode",value:function(e,t){void 0!==e&&null!==e&&void 0!==t&&null!==t&&this.fetchJsonApiPatch("patch","".concat(j,"node/article/").concat(e),t)}},{key:"fetchJsonApiPatch",value:function(e,t,n){var a=this;this.fetchWithCSRFToken(t,{method:"PATCH",credentials:"same-origin",headers:O,body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(t){a.updateData(e,t,!1),a.loadNodeData()})).catch((function(e){return console.log("API error:",e)}))}},{key:"deleteNode",value:function(e){void 0!==e&&null!==e&&this.fetchJsonApiDelete("delete","".concat(j,"node/article/").concat(e))}},{key:"fetchJsonApiDelete",value:function(e,t){var n=this;this.fetchWithCSRFToken(t,{method:"DELETE",credentials:"same-origin",headers:O}).then((function(e){return console.log(e),e})).then((function(e){n.fetchJsonApiGet("data","".concat(j,"node/article"))})).catch((function(e){return console.log("API error:",e)}))}},{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement("hr",null),o.a.createElement("h2",null,"All Articles"),o.a.createElement(v,{data:this.state.data,patchNode:this.patchNode,deleteNode:this.deleteNode}),o.a.createElement("hr",null),o.a.createElement(y,{postNode:this.postNode}))}}]),n}(o.a.Component);c.a.render(o.a.createElement(N,null),document.getElementById("react-app"))},9:function(e,t,n){e.exports=n(16)}},[[9,1,2]]]);
//# sourceMappingURL=main.920cb870.chunk.js.map